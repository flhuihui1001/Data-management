{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Data source:\n",
    "\n",
    "The data is from US department of education, you can download the data here: https://ed-public-download.apps.cloud.gov/downloads/CollegeScorecard_Raw_Data.zip.\n",
    "\n",
    "For detailed explaination of each column, you can see the database documentation: https://collegescorecard.ed.gov/assets/FullDataDocumentation.pdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--2016-12-02 22:30:04--  https://ed-public-download.apps.cloud.gov/downloads/CollegeScorecard_Raw_Data.zip\n",
      "Resolving ed-public-download.apps.cloud.gov (ed-public-download.apps.cloud.gov)... 107.23.95.12, 52.73.98.33, 2406:da00:ff00::3449:6221, ...\n",
      "Connecting to ed-public-download.apps.cloud.gov (ed-public-download.apps.cloud.gov)|107.23.95.12|:443... connected.\n",
      "HTTP request sent, awaiting response... 200 OK\n",
      "Length: 240264190 (229M) [application/zip]\n",
      "Saving to: ‘CollegeScorecard_Raw_Data.zip’\n",
      "\n",
      "CollegeScorecard_Ra 100%[=====================>] 229.13M  47.7MB/s   in 6.6s   \n",
      "\n",
      "2016-12-02 22:30:11 (34.7 MB/s) - ‘CollegeScorecard_Raw_Data.zip’ saved [240264190/240264190]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "!wget https://ed-public-download.apps.cloud.gov/downloads/CollegeScorecard_Raw_Data.zip"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Archive:  CollegeScorecard_Raw_Data.zip\n",
      "  inflating: Crosswalks_20160908.zip  \n",
      "  inflating: MERGED1996_97_PP.csv    \n",
      "  inflating: MERGED1997_98_PP.csv    \n",
      "  inflating: MERGED1998_99_PP.csv    \n",
      "  inflating: MERGED1999_00_PP.csv    \n",
      "  inflating: MERGED2000_01_PP.csv    \n",
      "  inflating: MERGED2001_02_PP.csv    \n",
      "  inflating: MERGED2002_03_PP.csv    \n",
      "  inflating: MERGED2003_04_PP.csv    \n",
      "  inflating: MERGED2004_05_PP.csv    \n",
      "  inflating: MERGED2005_06_PP.csv    \n",
      "  inflating: MERGED2006_07_PP.csv    \n",
      "  inflating: MERGED2007_08_PP.csv    \n",
      "  inflating: MERGED2008_09_PP.csv    \n",
      "  inflating: MERGED2009_10_PP.csv    \n",
      "  inflating: MERGED2010_11_PP.csv    \n",
      "  inflating: MERGED2011_12_PP.csv    \n",
      "  inflating: MERGED2012_13_PP.csv    \n",
      "  inflating: MERGED2013_14_PP.csv    \n",
      "  inflating: MERGED2014_15_PP.csv    \n"
     ]
    }
   ],
   "source": [
    "!unzip CollegeScorecard_Raw_Data.zip"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7704 MERGED2014_15_PP.csv\r\n"
     ]
    }
   ],
   "source": [
    "!wc -l MERGED2014_15_PP.csv"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Choose useful columns to create new datasets"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "I choose 25 columns that correlated with 7 aspects (listed in the order as the database)\n",
    "\n",
    "### Basic information about Institutions\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    \n",
    "### Award of the institution    \n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    \n",
    "    There are several elements that identify the degree profile of the institution. Highest degree (HIGHDEG) identifies the highest award level. This designation differs from the highest degree element in that it is based on an institution’s reported offerings, rather than on degree or certificate completions. For example, an institution may offer a bachelor’s degree program but only infrequently have students that earn the degree. The level of institution element would consistently classify this institution as 4-year, but the highest degree element would potentially vary from year-to-year.\n",
    "    \n",
    "### Administration rate    \n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    \n",
    "    For institutions with multiple branches, ADM_RATE includes the admissions rate at each campus, while ADM_RATE_ALL represents the admissions rate across all campuses, defined as the total number of admitted undergraduates across all branches divided by the total number of undergraduates who applied across all branches.\n",
    "    \n",
    "### SAT scores\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    \n",
    "### Retention rate\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    \n",
    "    Available through the IPEDS Fall Enrollment component, retention rate identifies (separately) the share of full-time and part-time students in the prior year, at four-year (RET_FT4 and RET_PT4) and less-than-four- year institutions (RET_FTL4 and RET_PTL4), who return to the institution after the first year.\n",
    "    \n",
    "### Family income\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    \n",
    "    Using data from NSLDS, these elements calculate the percentage of Title IV-receiving students who had family income data from the Free Application for Federal Student Aid (FAFSA) for each of five income quintiles16 (INC_PCT_LO = $0-$30,000; INC_PCT_M1 = $30,001-$48,000; INC_PCT_M2=$48,001-$75,000; INC_PCT_H1=$75,001-$110,000; and INC_PCT_H2 = $110,001+). \n",
    "    \n",
    "### Debt of students\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18)\n",
    "    \n",
    "    This is the median loan debt accumulatedat the institution by all student borrowers of federal loans who separate (i.e., either graduate or withdraw) in a given fiscal year, measured at the point of separation (DEBT_MDN).More specifically, the measure represents the sum of all undergraduate federal loans over students’ college education at the institution for which the median debt is reported for —e.g., if a student receives a federal loan for $2,000 for each of eight semesters at one institution,their cumulative debt is recorded as $16,000 forthat institution.\n",
    "    These data are available for all borrowers at the institution, as well as disaggregated by completion status (GRAD_DEBT_MDN for students who completed and WDRAW_DEBT_MDN for students who withdrew without completing25); by FAFSA family income26 (LO_INC_DEBT_MDN = $0-$30,000; MD_INC_DEBT_MDN = $30,001-$75,000; and HI_INC_DEBT_MDN = $75,001+); \n",
    "    \n",
    "### Earnings\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    \n",
    "    Mean (MN_EARN_WNE_P*) and median (MD_EARN_WNE_P*) earnings are for the institutional aggregate of all federally aided students who enroll in an institution each year and who are employed but not enrolled. Earnings are defined as the sum of wages and deferred compensation from all non-duplicate W-2 forms received for each individual, plus positive self- employment earnings from Schedule SE. Data are available for each year starting six years after a student enrolls in college, up to 10 years after the student enrolls; enrollment dates are estimated based on FAFSA self-reporting, as with the completion rate cohort construction described above.\n",
    "    \n",
    "    Mean earnings are also available disaggregated by FAFSA family income31 (MN_EARN_WNE_INC1_P*, MN_EARN_WNE_INC2_P*, and MN_EARN_WNE_INC3_P*); by dependent status (for dependents, MN_EARN_WNE_INDEP0 _P*; and for independents, MN_EARN_WNE_INDEP1_P*); and by gender (for female, MN_EARN_WNE_MALE0_P*; and for male, MN_EARN_WNE_MALE1_P*).\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2014_15_PP.csv > education15.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2013_14_PP.csv > education14.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2012_13_PP.csv > education13.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2011_12_PP.csv > education12.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2010_11_PP.csv > education11.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2009_10_PP.csv > education10.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2008_09_PP.csv > education09.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2007_08_PP.csv > education08.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2006_07_PP.csv > education07.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2005_06_PP.csv > education06.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,5,6,7,16,1739,37,38,60,61,429,430,431,432,1408,1413,1414,1415,1416,1504,1505,1506,1507,1508,1509,1665,1691,1696,1706,1639,1666,1697,1640 MERGED2004_05_PP.csv > education05.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.5/site-packages/IPython/config.py:13: ShimWarning: The `IPython.config` package has been deprecated. You should import from traitlets.config instead.\n",
      "  \"You should import from traitlets.config instead.\", ShimWarning)\n",
      "/opt/conda/lib/python3.5/site-packages/IPython/utils/traitlets.py:5: UserWarning: IPython.utils.traitlets has moved to a top-level traitlets package.\n",
      "  warn(\"IPython.utils.traitlets has moved to a top-level traitlets package.\")\n"
     ]
    }
   ],
   "source": [
    "%load_ext sql"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[sudo] password for jovyan: Restarting PostgreSQL 9.5 database server: main.\n"
     ]
    }
   ],
   "source": [
    "!echo 'redspot' | sudo -S service postgresql restart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "createdb: database creation failed: ERROR:  database \"education\" already exists\r\n"
     ]
    }
   ],
   "source": [
    "!createdb -U dbuser education"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Connected: dbuser@education'"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%sql postgresql://dbuser@localhost:5432/education"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load csv to database and add corresponding year for every record"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  1. INSTNM\n",
      "\t<class 'str'>\n",
      "\tNulls: False\n",
      "\tUnique values: 7535\n",
      "\t5 most frequent values:\n",
      "\t\tUEI College:\t8\n",
      "\t\tStevens-Henager College:\t7\n",
      "\t\tMcCann School of Business & Technology:\t7\n",
      "\t\tColumbia College:\t5\n",
      "\t\tBryan University:\t5\n",
      "\tMax length: 93\n",
      "  2. CITY\n",
      "\t<class 'str'>\n",
      "\tNulls: False\n",
      "\tUnique values: 2542\n",
      "\t5 most frequent values:\n",
      "\t\tNew York:\t89\n",
      "\t\tChicago:\t80\n",
      "\t\tHouston:\t75\n",
      "\t\tLos Angeles:\t57\n",
      "\t\tMiami:\t53\n",
      "\tMax length: 24\n",
      "  3. STABBR\n",
      "\t<class 'str'>\n",
      "\tNulls: False\n",
      "\tUnique values: 59\n",
      "\t5 most frequent values:\n",
      "\t\tCA:\t795\n",
      "\t\tTX:\t485\n",
      "\t\tNY:\t467\n",
      "\t\tFL:\t446\n",
      "\t\tPA:\t405\n",
      "\tMax length: 2\n",
      "  4. ZIP\n",
      "\t<class 'str'>\n",
      "\tNulls: False\n",
      "\tUnique values: 6513\n",
      "\t5 most frequent values:\n",
      "\t\t90010:\t9\n",
      "\t\t78229:\t9\n",
      "\t\t85021:\t8\n",
      "\t\t23462:\t7\n",
      "\t\t00961:\t7\n",
      "\tMax length: 10\n",
      "  5. HIGHDEG\n",
      "\t<class 'int'>\n",
      "\tNulls: False\n",
      "\tValues: 0, 1, 2, 3, 4\n",
      "  6. ICLEVEL\n",
      "\t<class 'int'>\n",
      "\tNulls: False\n",
      "\tValues: 1, 2, 3\n",
      "  7. ADM_RATE\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 1519.6226999999992\n",
      "\tMean: 0.6913661055505\n",
      "\tMedian: 0.71295\n",
      "\tStandard Deviation: 0.20888087166216035\n",
      "\tUnique values: 1719\n",
      "\t5 most frequent values:\n",
      "\t\t1.0:\t142\n",
      "\t\t0.6667:\t15\n",
      "\t\t0.8889:\t6\n",
      "\t\t0.5:\t6\n",
      "\t\t0.75:\t6\n",
      "  8. ADM_RATE_ALL\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 1660.7129671758555\n",
      "\tMean: 0.6913875800066009\n",
      "\tMedian: 0.718305827917755\n",
      "\tStandard Deviation: 0.20372609643152892\n",
      "\tUnique values: 1706\n",
      "\t5 most frequent values:\n",
      "\t\t1.0:\t146\n",
      "\t\t0.85361152058056:\t142\n",
      "\t\t0.77418668934722:\t25\n",
      "\t\t0.62651766688141:\t24\n",
      "\t\t0.7404536319265:\t18\n",
      "  9. SAT_AVG\n",
      "\t<class 'int'>\n",
      "\tNulls: True\n",
      "\tMin: 720\n",
      "\tMax: 1545\n",
      "\tSum: 1381030\n",
      "\tMean: 1059.0720858895706\n",
      "\tMedian: 1039.5\n",
      "\tStandard Deviation: 133.30583529564603\n",
      "\tUnique values: 472\n",
      "\t5 most frequent values:\n",
      "\t\t1050:\t26\n",
      "\t\t1010:\t26\n",
      "\t\t1030:\t20\n",
      "\t\t970:\t20\n",
      "\t\t990:\t19\n",
      " 10. SAT_AVG_ALL\n",
      "\t<class 'int'>\n",
      "\tNulls: True\n",
      "\tMin: 720\n",
      "\tMax: 1545\n",
      "\tSum: 1502135\n",
      "\tMean: 1064.5889440113394\n",
      "\tMedian: 1050\n",
      "\tStandard Deviation: 131.57394675190932\n",
      "\tUnique values: 467\n",
      "\t5 most frequent values:\n",
      "\t\t1050:\t39\n",
      "\t\t1089:\t30\n",
      "\t\t1010:\t25\n",
      "\t\t1030:\t24\n",
      "\t\t990:\t20\n",
      " 11. RET_FT4\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 1621.3364999999976\n",
      "\tMean: 0.7070808983863923\n",
      "\tMedian: 0.7414\n",
      "\tStandard Deviation: 0.19560223518797457\n",
      "\tUnique values: 1505\n",
      "\t5 most frequent values:\n",
      "\t\t1.0:\t92\n",
      "\t\t0.5:\t57\n",
      "\t\t0.0:\t48\n",
      "\t\t0.6667:\t35\n",
      "\t\t0.75:\t27\n",
      " 12. RET_FTL4\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 2636.8946000000055\n",
      "\tMean: 0.6861552432995071\n",
      "\tMedian: 0.6906\n",
      "\tStandard Deviation: 0.18009762742777305\n",
      "\tUnique values: 1712\n",
      "\t5 most frequent values:\n",
      "\t\t1.0:\t215\n",
      "\t\t0.6667:\t85\n",
      "\t\t0.75:\t81\n",
      "\t\t0.8:\t69\n",
      "\t\t0.5:\t66\n",
      " 13. RET_PT4\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 643.3620000000001\n",
      "\tMean: 0.4556388101983003\n",
      "\tMedian: 0.45\n",
      "\tStandard Deviation: 0.2932212878519834\n",
      "\tUnique values: 389\n",
      "\t5 most frequent values:\n",
      "\t\t0.0:\t184\n",
      "\t\t1.0:\t155\n",
      "\t\t0.5:\t150\n",
      "\t\t0.3333:\t70\n",
      "\t\t0.6667:\t45\n",
      " 14. RET_PTL4\n",
      "\t<class 'float'>\n",
      "\tNulls: True\n",
      "\tMin: 0.0\n",
      "\tMax: 1.0\n",
      "\tSum: 1246.8121999999948\n",
      "\tMean: 0.5646794384057948\n",
      "\tMedian: 0.50325\n",
      "\tStandard Deviation: 0.26348012864607384\n",
      "\tUnique values: 1009\n",
      "\t5 most frequent values:\n",
      "\t\t1.0:\t244\n",
      "\t\t0.0:\t75\n",
      "\t\t0.5:\t71\n",
      "\t\t0.6667:\t60\n",
      "\t\t0.75:\t46\n",
      " 15. INC_PCT_LO\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 4536\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t476\n",
      "\t\t0.7181093571:\t142\n",
      "\t\t0.7708312692:\t85\n",
      "\t\t0.7320481758:\t81\n",
      "\t\t0.7322646003:\t38\n",
      "\tMax length: 17\n",
      " 16. INC_PCT_M1\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 3802\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t1217\n",
      "\t\t0.1437831467:\t142\n",
      "\t\t0.0959080551:\t85\n",
      "\t\t0.152076969:\t81\n",
      "\t\t0.1411651797:\t38\n",
      "\tMax length: 17\n",
      " 17. INC_PCT_M2\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 3470\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t1900\n",
      "\t\t0.0815370778:\t142\n",
      "\t\t0.0624194987:\t85\n",
      "\t\t0.0731064995:\t81\n",
      "\t\t0.0773824334:\t38\n",
      "\tMax length: 17\n",
      " 18. INC_PCT_H1\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 2999\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t2659\n",
      "\t\t0.0383339019:\t142\n",
      "\t\t0.0433964134:\t85\n",
      "\t\t0.0283015555:\t81\n",
      "\t\t0.0325880638:\t38\n",
      "\tMax length: 17\n",
      " 19. INC_PCT_H2\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 2995\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t2695\n",
      "\t\t0.0182365165:\t142\n",
      "\t\t0.0274447637:\t85\n",
      "\t\t0.0144668001:\t81\n",
      "\t\t0.0165997227:\t38\n",
      "\tMax length: 17\n",
      " 20. DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 2096\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t990\n",
      "\t\t9500:\t904\n",
      "\t\t5500:\t224\n",
      "\t\t13566:\t142\n",
      "\t\t12000:\t135\n",
      "\tMax length: 17\n",
      " 21. GRAD_DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 2118\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t1408\n",
      "\t\t9500:\t546\n",
      "\t\t27000:\t319\n",
      "\t\t25827.5:\t142\n",
      "\t\t25000:\t125\n",
      "\tMax length: 17\n",
      " 22. WDRAW_DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 1572\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t1594\n",
      "\t\t4750:\t910\n",
      "\t\t9500:\t641\n",
      "\t\t5500:\t362\n",
      "\t\t6334:\t165\n",
      "\tMax length: 17\n",
      " 23. LO_INC_DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 2182\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t1534\n",
      "\t\t9500:\t908\n",
      "\t\t12667:\t154\n",
      "\t\t5500:\t95\n",
      "\t\t6333:\t92\n",
      "\tMax length: 17\n",
      " 24. MD_INC_DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 1650\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t2406\n",
      "\t\t9500:\t442\n",
      "\t\t5500:\t178\n",
      "\t\t17014:\t142\n",
      "\t\t20000:\t102\n",
      "\tMax length: 17\n",
      " 25. HI_INC_DEBT_MDN\n",
      "\t<class 'str'>\n",
      "\tNulls: True\n",
      "\tUnique values: 1421\n",
      "\t5 most frequent values:\n",
      "\t\tPrivacySuppressed:\t2394\n",
      "\t\t5500:\t486\n",
      "\t\t9500:\t265\n",
      "\t\t12000:\t223\n",
      "\t\t17000:\t156\n",
      "\tMax length: 17\n",
      " 26. MN_EARN_WNE_P6\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 27. MN_EARN_WNE_P7\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 28. MN_EARN_WNE_P8\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 29. MN_EARN_WNE_P9\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 30. MN_EARN_WNE_P10\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 31. MD_EARN_WNE_P6\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 32. MD_EARN_WNE_P8\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      " 33. MD_EARN_WNE_P10\n",
      "\t<class 'NoneType'>\n",
      "\tNulls: True\n",
      "\tValues: \n",
      "\n",
      "Row count: 7703\n"
     ]
    }
   ],
   "source": [
    "!csvstat education15.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education15;\n",
    "CREATE TABLE education15 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7703 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education15 FROM '/home/jovyan/work/education15.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education15\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2015"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education14;\n",
    "CREATE TABLE education14 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7804 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education14 FROM '/home/jovyan/work/education14.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education14\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2014"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education13;\n",
    "CREATE TABLE education13 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7793 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education13 FROM '/home/jovyan/work/education13.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education13\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2013"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education12;\n",
    "CREATE TABLE education12 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7675 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education12 FROM '/home/jovyan/work/education12.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education12\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2012"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education11;\n",
    "CREATE TABLE education11 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7414 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education11 FROM '/home/jovyan/work/education11.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education11\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2011"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education10;\n",
    "CREATE TABLE education10 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7149 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education10 FROM '/home/jovyan/work/education10.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education10\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2010"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education09;\n",
    "CREATE TABLE education09 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6975 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education09 FROM '/home/jovyan/work/education09.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education09\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2009"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education08;\n",
    "CREATE TABLE education08 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6890 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education08 FROM '/home/jovyan/work/education08.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education08\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2008"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education07;\n",
    "CREATE TABLE education07 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6848 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education07 FROM '/home/jovyan/work/education07.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education07\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2007"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education06;\n",
    "CREATE TABLE education06 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6824 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education06 FROM '/home/jovyan/work/education06.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education06\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2006"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education05;\n",
    "CREATE TABLE education05 (\n",
    "    INSTITUTION CHAR(94),\n",
    "    CITY CHAR(25),\n",
    "    STABBR CHAR(2),\n",
    "    ZIP CHAR(11),\n",
    "    HIGHDEG INT,\n",
    "    ICLEVEL CHAR(11),\n",
    "    ADM_RATE CHAR(18),\n",
    "    ADM_RATE_ALL CHAR(18),\n",
    "    SAT_AVG CHAR(8),\n",
    "    SAT_AVG_ALL CHAR(8),\n",
    "    RET_FT4 CHAR(18),\n",
    "    RET_FTL4 CHAR(18),\n",
    "    RET_PT4 CHAR(18),\n",
    "    RET_PTL4 CHAR(18),\n",
    "    INC_PCT_LO CHAR(18),\n",
    "    INC_PCT_M1 CHAR(18),\n",
    "    INC_PCT_M2 CHAR(18),\n",
    "    INC_PCT_H1 CHAR(18),\n",
    "    INC_PCT_H2 CHAR(18),\n",
    "    DEBT_MDN CHAR(18),   \n",
    "    GRAD_DEBT_MDN CHAR(18),\n",
    "    WDRAW_DEBT_MDN CHAR(18),\n",
    "    LO_INC_DEBT_MDN CHAR(18),\n",
    "    MD_INC_DEBT_MDN CHAR(18),\n",
    "    HI_INC_DEBT_MDN CHAR(18),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6660 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY education05 FROM '/home/jovyan/work/education05.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE education05\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2005"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Merge all datasets into one and put it into database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "79735 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS education;\n",
    "SELECT *\n",
    "INTO education \n",
    "FROM (\n",
    "    SELECT * FROM education15 \n",
    "    UNION ALL \n",
    "    SELECT * FROM education14\n",
    "    UNION ALL \n",
    "    SELECT * FROM education13\n",
    "    UNION ALL \n",
    "    SELECT * FROM education12\n",
    "    UNION ALL \n",
    "    SELECT * FROM education11\n",
    "    UNION ALL \n",
    "    SELECT * FROM education10\n",
    "    UNION ALL \n",
    "    SELECT * FROM education09\n",
    "    UNION ALL \n",
    "    SELECT * FROM education08\n",
    "    UNION ALL \n",
    "    SELECT * FROM education07\n",
    "    UNION ALL \n",
    "    SELECT * FROM education06\n",
    "    UNION ALL \n",
    "    SELECT * FROM education05\n",
    "    ) AS educational"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>79735</td>\n",
       "    </tr>\n",
       "</table>"
      ],
      "text/plain": [
       "[(79735,)]"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "SELECT count(*) FROM education"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <th>institution</th>\n",
       "        <th>city</th>\n",
       "        <th>stabbr</th>\n",
       "        <th>zip</th>\n",
       "        <th>highdeg</th>\n",
       "        <th>iclevel</th>\n",
       "        <th>adm_rate</th>\n",
       "        <th>adm_rate_all</th>\n",
       "        <th>sat_avg</th>\n",
       "        <th>sat_avg_all</th>\n",
       "        <th>ret_ft4</th>\n",
       "        <th>ret_ftl4</th>\n",
       "        <th>ret_pt4</th>\n",
       "        <th>ret_ptl4</th>\n",
       "        <th>inc_pct_lo</th>\n",
       "        <th>inc_pct_m1</th>\n",
       "        <th>inc_pct_m2</th>\n",
       "        <th>inc_pct_h1</th>\n",
       "        <th>inc_pct_h2</th>\n",
       "        <th>debt_mdn</th>\n",
       "        <th>grad_debt_mdn</th>\n",
       "        <th>wdraw_debt_mdn</th>\n",
       "        <th>lo_inc_debt_mdn</th>\n",
       "        <th>md_inc_debt_mdn</th>\n",
       "        <th>hi_inc_debt_mdn</th>\n",
       "        <th>mn_earn_wne_p6</th>\n",
       "        <th>mn_earn_wne_p7</th>\n",
       "        <th>mn_earn_wne_p8</th>\n",
       "        <th>mn_earn_wne_p9</th>\n",
       "        <th>mn_earn_wne_p10</th>\n",
       "        <th>md_earn_wne_p6</th>\n",
       "        <th>md_earn_wne_p8</th>\n",
       "        <th>md_earn_wne_p10</th>\n",
       "        <th>year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>University of Alabama at Birmingham                                                           </td>\n",
       "        <td>Birmingham               </td>\n",
       "        <td>AL</td>\n",
       "        <td>35294-0110 </td>\n",
       "        <td>4</td>\n",
       "        <td>1          </td>\n",
       "        <td>0.8569            </td>\n",
       "        <td>0.85691768826619  </td>\n",
       "        <td>1107    </td>\n",
       "        <td>1107    </td>\n",
       "        <td>0.8288            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.575             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.4627393838      </td>\n",
       "        <td>0.1623646961      </td>\n",
       "        <td>0.1388426311      </td>\n",
       "        <td>0.1286427977      </td>\n",
       "        <td>0.1074104913      </td>\n",
       "        <td>14382             </td>\n",
       "        <td>21941.5           </td>\n",
       "        <td>10000             </td>\n",
       "        <td>14725             </td>\n",
       "        <td>14692.5           </td>\n",
       "        <td>14000             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Amridge University                                                                            </td>\n",
       "        <td>Montgomery               </td>\n",
       "        <td>AL</td>\n",
       "        <td>36117-3553 </td>\n",
       "        <td>4</td>\n",
       "        <td>1          </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL    </td>\n",
       "        <td>NULL    </td>\n",
       "        <td>0                 </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.6667            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.7975830816      </td>\n",
       "        <td>0.1359516616      </td>\n",
       "        <td>0.0332326284      </td>\n",
       "        <td>PrivacySuppressed </td>\n",
       "        <td>PrivacySuppressed </td>\n",
       "        <td>9500              </td>\n",
       "        <td>23370             </td>\n",
       "        <td>8687.5            </td>\n",
       "        <td>8563              </td>\n",
       "        <td>15750             </td>\n",
       "        <td>13882             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>University of Alabama in Huntsville                                                           </td>\n",
       "        <td>Huntsville               </td>\n",
       "        <td>AL</td>\n",
       "        <td>35899      </td>\n",
       "        <td>4</td>\n",
       "        <td>1          </td>\n",
       "        <td>0.8203            </td>\n",
       "        <td>0.82034220532319  </td>\n",
       "        <td>1219    </td>\n",
       "        <td>1219    </td>\n",
       "        <td>0.7696            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.6154            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.4565544952      </td>\n",
       "        <td>0.1376192868      </td>\n",
       "        <td>0.1426418885      </td>\n",
       "        <td>0.138121547       </td>\n",
       "        <td>0.1250627825      </td>\n",
       "        <td>15750             </td>\n",
       "        <td>24097             </td>\n",
       "        <td>9500              </td>\n",
       "        <td>17107             </td>\n",
       "        <td>16938             </td>\n",
       "        <td>14000             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Alabama State University                                                                      </td>\n",
       "        <td>Montgomery               </td>\n",
       "        <td>AL</td>\n",
       "        <td>36104-0271 </td>\n",
       "        <td>4</td>\n",
       "        <td>1          </td>\n",
       "        <td>0.5326            </td>\n",
       "        <td>0.53264694382901  </td>\n",
       "        <td>851     </td>\n",
       "        <td>851     </td>\n",
       "        <td>0.5725            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.28              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.6714959569      </td>\n",
       "        <td>0.1644204852      </td>\n",
       "        <td>0.0838948787      </td>\n",
       "        <td>0.0488544474      </td>\n",
       "        <td>0.0313342318      </td>\n",
       "        <td>14362             </td>\n",
       "        <td>33118.5           </td>\n",
       "        <td>11500             </td>\n",
       "        <td>14250             </td>\n",
       "        <td>15019             </td>\n",
       "        <td>14250             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Alabama A &amp; M University                                                                      </td>\n",
       "        <td>Normal                   </td>\n",
       "        <td>AL</td>\n",
       "        <td>35762      </td>\n",
       "        <td>4</td>\n",
       "        <td>1          </td>\n",
       "        <td>0.5256            </td>\n",
       "        <td>0.52560347439652  </td>\n",
       "        <td>827     </td>\n",
       "        <td>827     </td>\n",
       "        <td>0.6595            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.3333            </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>0.6515211379      </td>\n",
       "        <td>0.167917819       </td>\n",
       "        <td>0.0975898854      </td>\n",
       "        <td>0.0513630976      </td>\n",
       "        <td>0.0316080601      </td>\n",
       "        <td>15000             </td>\n",
       "        <td>33888             </td>\n",
       "        <td>11500             </td>\n",
       "        <td>14413             </td>\n",
       "        <td>18255             </td>\n",
       "        <td>17250             </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>NULL              </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "</table>"
      ],
      "text/plain": [
       "[('University of Alabama at Birmingham                                                           ', 'Birmingham               ', 'AL', '35294-0110 ', 4, '1          ', '0.8569            ', '0.85691768826619  ', '1107    ', '1107    ', '0.8288            ', 'NULL              ', '0.575             ', 'NULL              ', '0.4627393838      ', '0.1623646961      ', '0.1388426311      ', '0.1286427977      ', '0.1074104913      ', '14382             ', '21941.5           ', '10000             ', '14725             ', '14692.5           ', '14000             ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 2015),\n",
       " ('Amridge University                                                                            ', 'Montgomery               ', 'AL', '36117-3553 ', 4, '1          ', 'NULL              ', 'NULL              ', 'NULL    ', 'NULL    ', '0                 ', 'NULL              ', '0.6667            ', 'NULL              ', '0.7975830816      ', '0.1359516616      ', '0.0332326284      ', 'PrivacySuppressed ', 'PrivacySuppressed ', '9500              ', '23370             ', '8687.5            ', '8563              ', '15750             ', '13882             ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 2015),\n",
       " ('University of Alabama in Huntsville                                                           ', 'Huntsville               ', 'AL', '35899      ', 4, '1          ', '0.8203            ', '0.82034220532319  ', '1219    ', '1219    ', '0.7696            ', 'NULL              ', '0.6154            ', 'NULL              ', '0.4565544952      ', '0.1376192868      ', '0.1426418885      ', '0.138121547       ', '0.1250627825      ', '15750             ', '24097             ', '9500              ', '17107             ', '16938             ', '14000             ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 2015),\n",
       " ('Alabama State University                                                                      ', 'Montgomery               ', 'AL', '36104-0271 ', 4, '1          ', '0.5326            ', '0.53264694382901  ', '851     ', '851     ', '0.5725            ', 'NULL              ', '0.28              ', 'NULL              ', '0.6714959569      ', '0.1644204852      ', '0.0838948787      ', '0.0488544474      ', '0.0313342318      ', '14362             ', '33118.5           ', '11500             ', '14250             ', '15019             ', '14250             ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 2015),\n",
       " ('Alabama A & M University                                                                      ', 'Normal                   ', 'AL', '35762      ', 4, '1          ', '0.5256            ', '0.52560347439652  ', '827     ', '827     ', '0.6595            ', 'NULL              ', '0.3333            ', 'NULL              ', '0.6515211379      ', '0.167917819       ', '0.0975898854      ', '0.0513630976      ', '0.0316080601      ', '15000             ', '33888             ', '11500             ', '14413             ', '18255             ', '17250             ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 'NULL              ', 2015)]"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "SELECT * FROM education\n",
    "ORDER BY year DESC\n",
    "LIMIT 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Another dataset about earnings for 2015\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--2016-12-02 22:33:07--  https://ed-public-download.apps.cloud.gov/downloads/Most-Recent-Cohorts-Treasury-Elements.csv\n",
      "Resolving ed-public-download.apps.cloud.gov (ed-public-download.apps.cloud.gov)... 52.73.98.33, 107.23.95.12, 2406:da00:ff00::6b17:5f0c, ...\n",
      "Connecting to ed-public-download.apps.cloud.gov (ed-public-download.apps.cloud.gov)|52.73.98.33|:443... connected.\n",
      "HTTP request sent, awaiting response... 200 OK\n",
      "Length: 5886017 (5.6M) [text/csv]\n",
      "Saving to: ‘Most-Recent-Cohorts-Treasury-Elements.csv.1’\n",
      "\n",
      "Most-Recent-Cohorts 100%[=====================>]   5.61M  13.6MB/s   in 0.4s   \n",
      "\n",
      "2016-12-02 22:33:08 (13.6 MB/s) - ‘Most-Recent-Cohorts-Treasury-Elements.csv.1’ saved [5886017/5886017]\n",
      "\n"
     ]
    }
   ],
   "source": [
    "!wget https://ed-public-download.apps.cloud.gov/downloads/Most-Recent-Cohorts-Treasury-Elements.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  1: ﻿UNITID\r\n",
      "  2: OPEID\r\n",
      "  3: OPEID6\r\n",
      "  4: INSTNM\r\n",
      "  5: COUNT_ED\r\n",
      "  6: AGEGE24\r\n",
      "  7: PCT_WHITE\r\n",
      "  8: PCT_BLACK\r\n",
      "  9: PCT_ASIAN\r\n",
      " 10: PCT_HISPANIC\r\n",
      " 11: PCT_BA\r\n",
      " 12: PCT_GRAD_PROF\r\n",
      " 13: PCT_BORN_US\r\n",
      " 14: MEDIAN_HH_INC\r\n",
      " 15: POVERTY_RATE\r\n",
      " 16: UNEMP_RATE\r\n",
      " 17: LN_MEDIAN_HH_INC\r\n",
      " 18: COUNT_NWNE_P10\r\n",
      " 19: COUNT_WNE_P10\r\n",
      " 20: MN_EARN_WNE_P10\r\n",
      " 21: MD_EARN_WNE_P10\r\n",
      " 22: PCT10_EARN_WNE_P10\r\n",
      " 23: PCT25_EARN_WNE_P10\r\n",
      " 24: PCT75_EARN_WNE_P10\r\n",
      " 25: PCT90_EARN_WNE_P10\r\n",
      " 26: SD_EARN_WNE_P10\r\n",
      " 27: COUNT_WNE_INC1_P10\r\n",
      " 28: COUNT_WNE_INC2_P10\r\n",
      " 29: COUNT_WNE_INC3_P10\r\n",
      " 30: COUNT_WNE_INDEP0_INC1_P10\r\n",
      " 31: COUNT_WNE_INDEP0_P10\r\n",
      " 32: COUNT_WNE_INDEP1_P10\r\n",
      " 33: COUNT_WNE_MALE0_P10\r\n",
      " 34: COUNT_WNE_MALE1_P10\r\n",
      " 35: GT_25K_P10\r\n",
      " 36: MN_EARN_WNE_INC1_P10\r\n",
      " 37: MN_EARN_WNE_INC2_P10\r\n",
      " 38: MN_EARN_WNE_INC3_P10\r\n",
      " 39: MN_EARN_WNE_INDEP0_INC1_P10\r\n",
      " 40: MN_EARN_WNE_INDEP0_P10\r\n",
      " 41: MN_EARN_WNE_INDEP1_P10\r\n",
      " 42: MN_EARN_WNE_MALE0_P10\r\n",
      " 43: MN_EARN_WNE_MALE1_P10\r\n",
      " 44: COUNT_NWNE_P6\r\n",
      " 45: COUNT_WNE_P6\r\n",
      " 46: MN_EARN_WNE_P6\r\n",
      " 47: MD_EARN_WNE_P6\r\n",
      " 48: PCT10_EARN_WNE_P6\r\n",
      " 49: PCT25_EARN_WNE_P6\r\n",
      " 50: PCT75_EARN_WNE_P6\r\n",
      " 51: PCT90_EARN_WNE_P6\r\n",
      " 52: SD_EARN_WNE_P6\r\n",
      " 53: COUNT_WNE_INC1_P6\r\n",
      " 54: COUNT_WNE_INC2_P6\r\n",
      " 55: COUNT_WNE_INC3_P6\r\n",
      " 56: COUNT_WNE_INDEP0_INC1_P6\r\n",
      " 57: COUNT_WNE_INDEP0_P6\r\n",
      " 58: COUNT_WNE_INDEP1_P6\r\n",
      " 59: COUNT_WNE_MALE0_P6\r\n",
      " 60: COUNT_WNE_MALE1_P6\r\n",
      " 61: GT_25K_P6\r\n",
      " 62: MN_EARN_WNE_INC1_P6\r\n",
      " 63: MN_EARN_WNE_INC2_P6\r\n",
      " 64: MN_EARN_WNE_INC3_P6\r\n",
      " 65: MN_EARN_WNE_INDEP0_INC1_P6\r\n",
      " 66: MN_EARN_WNE_INDEP0_P6\r\n",
      " 67: MN_EARN_WNE_INDEP1_P6\r\n",
      " 68: MN_EARN_WNE_MALE0_P6\r\n",
      " 69: MN_EARN_WNE_MALE1_P6\r\n",
      " 70: COUNT_NWNE_P7\r\n",
      " 71: COUNT_WNE_P7\r\n",
      " 72: MN_EARN_WNE_P7\r\n",
      " 73: SD_EARN_WNE_P7\r\n",
      " 74: GT_25K_P7\r\n",
      " 75: COUNT_NWNE_P8\r\n",
      " 76: COUNT_WNE_P8\r\n",
      " 77: MN_EARN_WNE_P8\r\n",
      " 78: MD_EARN_WNE_P8\r\n",
      " 79: PCT10_EARN_WNE_P8\r\n",
      " 80: PCT25_EARN_WNE_P8\r\n",
      " 81: PCT75_EARN_WNE_P8\r\n",
      " 82: PCT90_EARN_WNE_P8\r\n",
      " 83: SD_EARN_WNE_P8\r\n",
      " 84: GT_25K_P8\r\n",
      " 85: COUNT_NWNE_P9\r\n",
      " 86: COUNT_WNE_P9\r\n",
      " 87: MN_EARN_WNE_P9\r\n",
      " 88: SD_EARN_WNE_P9\r\n",
      " 89: GT_25K_P9\r\n"
     ]
    }
   ],
   "source": [
    "!csvcut -n Most-Recent-Cohorts-Treasury-Elements.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "!csvcut -c4,46,72,77,87,20,47,78,21 Most-Recent-Cohorts-Treasury-Elements.csv > recentearnings.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n",
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "DROP TABLE IF EXISTS recentearnings;\n",
    "CREATE TABLE recentearnings (\n",
    "    INSTITUTION CHAR(94),\n",
    "    MN_EARN_WNE_P6 CHAR(18),\n",
    "    MN_EARN_WNE_P7 CHAR(18),\n",
    "    MN_EARN_WNE_P8 CHAR(18),\n",
    "    MN_EARN_WNE_P9 CHAR(18),\n",
    "    MN_EARN_WNE_P10 CHAR(18),\n",
    "    MD_EARN_WNE_P6 CHAR(18),\n",
    "    MD_EARN_WNE_P8 CHAR(18),\n",
    "    MD_EARN_WNE_P10 CHAR(18)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7703 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "COPY recentearnings FROM '/home/jovyan/work/recentearnings.csv'\n",
    "CSV\n",
    "HEADER\n",
    "QUOTE '\"'\n",
    "DELIMITER ',';"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "ALTER TABLE recentearnings\n",
    "ADD year INT NOT NULL \n",
    "CONSTRAINT year DEFAULT 2015"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5 rows affected.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <th>institution</th>\n",
       "        <th>mn_earn_wne_p6</th>\n",
       "        <th>mn_earn_wne_p7</th>\n",
       "        <th>mn_earn_wne_p8</th>\n",
       "        <th>mn_earn_wne_p9</th>\n",
       "        <th>mn_earn_wne_p10</th>\n",
       "        <th>md_earn_wne_p6</th>\n",
       "        <th>md_earn_wne_p8</th>\n",
       "        <th>md_earn_wne_p10</th>\n",
       "        <th>year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Alabama A &amp; M University                                                                      </td>\n",
       "        <td>25600             </td>\n",
       "        <td>29600             </td>\n",
       "        <td>30000             </td>\n",
       "        <td>33800             </td>\n",
       "        <td>35000             </td>\n",
       "        <td>22000             </td>\n",
       "        <td>26600             </td>\n",
       "        <td>30300             </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>University of Alabama at Birmingham                                                           </td>\n",
       "        <td>37500             </td>\n",
       "        <td>40000             </td>\n",
       "        <td>42000             </td>\n",
       "        <td>44500             </td>\n",
       "        <td>46300             </td>\n",
       "        <td>33300             </td>\n",
       "        <td>36900             </td>\n",
       "        <td>39700             </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Amridge University                                                                            </td>\n",
       "        <td>40100             </td>\n",
       "        <td>38700             </td>\n",
       "        <td>39100             </td>\n",
       "        <td>42400             </td>\n",
       "        <td>44800             </td>\n",
       "        <td>35200             </td>\n",
       "        <td>36400             </td>\n",
       "        <td>40100             </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>University of Alabama in Huntsville                                                           </td>\n",
       "        <td>39300             </td>\n",
       "        <td>43400             </td>\n",
       "        <td>44900             </td>\n",
       "        <td>50200             </td>\n",
       "        <td>50400             </td>\n",
       "        <td>35900             </td>\n",
       "        <td>40900             </td>\n",
       "        <td>45500             </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td>Alabama State University                                                                      </td>\n",
       "        <td>22200             </td>\n",
       "        <td>25200             </td>\n",
       "        <td>25700             </td>\n",
       "        <td>29400             </td>\n",
       "        <td>29400             </td>\n",
       "        <td>20300             </td>\n",
       "        <td>23000             </td>\n",
       "        <td>26600             </td>\n",
       "        <td>2015</td>\n",
       "    </tr>\n",
       "</table>"
      ],
      "text/plain": [
       "[('Alabama A & M University                                                                      ', '25600             ', '29600             ', '30000             ', '33800             ', '35000             ', '22000             ', '26600             ', '30300             ', 2015),\n",
       " ('University of Alabama at Birmingham                                                           ', '37500             ', '40000             ', '42000             ', '44500             ', '46300             ', '33300             ', '36900             ', '39700             ', 2015),\n",
       " ('Amridge University                                                                            ', '40100             ', '38700             ', '39100             ', '42400             ', '44800             ', '35200             ', '36400             ', '40100             ', 2015),\n",
       " ('University of Alabama in Huntsville                                                           ', '39300             ', '43400             ', '44900             ', '50200             ', '50400             ', '35900             ', '40900             ', '45500             ', 2015),\n",
       " ('Alabama State University                                                                      ', '22200             ', '25200             ', '25700             ', '29400             ', '29400             ', '20300             ', '23000             ', '26600             ', 2015)]"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "SELECT * FROM recentearnings\n",
    "LIMIT 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
